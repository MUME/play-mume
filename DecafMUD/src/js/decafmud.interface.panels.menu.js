/*! For license information please see decafmud.interface.panels.menu.js.LICENSE.txt */
var toolbar_menus=[["File","menu_file","Used for (re-)connecting.",["Reconnect","menu_reconnect();"]],["Log","menu_log","Create a log file for this session.",["HTML log","menu_log('html');","Plain Text Log","menu_log('plain');"]],["Options","menu_options","Change DecafMud Options",["Font (Size)","menu_font_size();","Macros","menu_macros();","Flush History","menu_history_flush();"]],["Help","menu_help","Info about DecafMUD and its usage.",["Client Features","menu_features();","About","menu_about();"]]],MENU_FILE=0,MENU_LOG=1,MENU_OPTIONS=2,MENU_HELP=3,MI_SUBMENU=3;function build_menu(e){var t=toolbar_menus[e][0]+'<ul id="sub'+toolbar_menus[e][1]+'" class="submenu">';for(j=0;j<toolbar_menus[e][3].length;j+=2)t+='<li><a href="javascript:'+toolbar_menus[e][3][j+1]+'">'+toolbar_menus[e][3][j]+"</a></li>";return t+"</ul>"}function get_menus(){var e=new Array;for(i=0;i<toolbar_menus.length;i++)e.push(toolbar_menus[i][1]),e.push(build_menu(i)),e.push(toolbar_menus[i][2]);return e}var popup,popupheader,headerdrag,open_menu=-1;function close_menus(){for(i=0;i<toolbar_menus.length;i++)menuname="sub"+toolbar_menus[i][1],document.getElementById(menuname).style.visibility="hidden";open_menu=-1,DecafMUD.instances[0].ui.input.focus()}function toggle_menu(e){menuid="sub"+toolbar_menus[e][1],open_menu==e?(document.getElementById(menuid).style.visibility="hidden",open_menu=-1,DecafMUD.instances[0].ui.input.focus()):(close_menus(),document.getElementById(menuid).style.visibility="visible",open_menu=e)}function show_popup(){if(null!=popup)for(;popup.children.length>0;)popup.removeChild(popup.children.item(1));popup=document.createElement("div");var e=DecafMUD.instances[0].ui.maxPopupWidth(),t=DecafMUD.instances[0].ui.maxPopupHeight(),n=DecafMUD.instances[0].ui.verticalPopupOffset(),o=DecafMUD.instances[0].ui.horizontalPopupOffset();o+=2*e/10,e=6*e/10,t=7*t/10,popup.style.width=e+"px",popup.style.height=t+"px",popup.style.top=n+"px",popup.style.left=o+"px",popup.className="decafmud window",popup.id="popup",DecafMUD.instances[0].ui.container.insertBefore(popup,DecafMUD.instances[0].ui.el_display),(popupheader=document.createElement("div")).style.width=e+"px",popupheader.style.height="25px",popupheader.style.top="0px",popupheader.className="decafmud window-header",popupheader.id="popupheader",popup.appendChild(popupheader),headerdrag=new dragObject("popup","popupheader");var a=document.createElement("button");return a.innerHTML="<big>X</big>",a.className="closebutton",a.onclick=function(){close_popup()},popup.appendChild(a),popup}function close_popup(){headerdrag.StopListening(!0),popup.parentNode.removeChild(popup),popup=void 0,popupheader=void 0}function add_element(e,t,n){var o=document.createElement(t);return o.innerHTML=n,e.appendChild(o),o}function button_line(e){var t=document.createElement("p");return t.style.textAlign="center",e.appendChild(t),t}function add_close_button(e){var t=document.createElement("a");t.className="fakebutton",t.href="javascript:close_popup();",t.innerHTML="<big>Close</big>",e.appendChild(t)}function popup_header(e){var t=document.createElement("p");t.innerHTML=e,t.style.marginLeft="5px",t.style.marginRight="5px",t.style.marginBottom="0px",t.style.fontSize="150%",t.className="headertext",popup.appendChild(t)}function popup_textarea(e,t){var n=6*DecafMUD.instances[0].ui.maxPopupWidth()/10-15,o=7*DecafMUD.instances[0].ui.maxPopupHeight()/10-100-t,a=document.createElement("textarea");return a.id=e,a.cols=80,a.rows=20,a.style.width=n+"px",a.style.height=o+"px",a.style.margin="5px",popup.appendChild(a),a}function popup_textdiv(){var e=6*DecafMUD.instances[0].ui.maxPopupWidth()/10-10,t=7*DecafMUD.instances[0].ui.maxPopupHeight()/10-60,n=document.createElement("div");return n.style.width=e+"px",n.style.height=t+"px",n.style.margin="5px",n.style.overflowY="auto",popup.appendChild(n),n}function menu_reconnect(){DecafMUD.instances[0].reconnect()}function menu_log(e){var t=show_popup(),n=popup_textarea("editor",70),o=DecafMUD.instances[0].ui.display.display.innerHTML;if("plain"==e)o=(o=(o=(o=(o=(o=o.replace(/\n/g," ")).replace(/<br>/g,"\n")).replace(/<.*?>/g,"")).replace(/&nbsp;/g," ")).replace(/\&lt;/g,"<")).replace(/\&gt;/g,">");else{var a=new Date;o="<html><head><title>DecafMUD "+a.getDate()+"/"+a.getMonth()+"/"+a.getFullYear()+'</title>\n<link rel="stylesheet" href="mud-colors.css" type="text/css" />\n</head><body>\n'+o+"</body></html>"}n.value=o,add_element(t,"p","To log, copy the text from this area to a text file (on most systems you can copy by clicking in the field, then ctrl+a, ctrl+c)."),"html"==e&&add_element(t,"p",'The css-file used for the colours can be downloaded <a href="mud-colors.css">here</a>.'),add_close_button(button_line(t))}function menu_font_size(){var e=popup_textdiv(show_popup());add_element(e,"h2","Change fonts.");var t=document.createElement("form");t.name="formfonts",e.appendChild(t),add_element(t,"p",'Font Size: <input name="txtfontsize" type="text" size=5 value="'+get_fontsize()+'">'),add_element(t,"p","(Select a value between 50 and 500 - the default size is 100.)"),add_element(t,"p",'Font Family: <input name="txtfontfamily" type="text" size=20 value="">'),add_element(t,"p","(Select a font that is supported by your browser, or leave empty for the current font.)");var n=document.createElement("a");n.className="fakebutton",n.href="javascript:change_font();",n.innerHTML="<big>Save</big>",t.appendChild(n),add_element(t,"span","&nbsp;&nbsp;&nbsp;");var o=document.createElement("a");o.className="fakebutton",o.href="javascript:close_popup();",o.innerHTML="<big>Cancel</big>",t.appendChild(o)}function change_font(){var e=parseInt(document.formfonts.txtfontsize.value);if(e<50||e>500)alert("Please select a size between 50 and 500.");else{set_fontsize(e);var t=document.formfonts.txtfontfamily.value;""!=t&&(DecafMUD.instances[0].ui.el_display.style.fontFamily="'"+t+"', Consolas, Courier, 'Courier New', 'Andale Mono', Monaco, monospace"),close_popup(),DecafMUD.instances[0].ui.display.scroll(),DecafMUD.instances[0].ui.input.focus()}}function menu_macros(){var e=popup_textdiv(show_popup());add_element(e,"p","Decafmud supports both F-key macro's (you need to use the mud's alias system to use them, for example <tt>alias f1 score</tt>), and numpad navigation (you need to turn numlock on for this to work).");var t=document.createElement("form");t.name="formmacros",e.appendChild(t),add_element(t,"p",'<input type="checkbox" name="cfkey" '+(fkeymacros?"checked":"")+"/>Enable f-key macros."),add_element(t,"p",'<input type="checkbox" name="cnumpad" '+(numpadwalking?"checked":"")+"/>Enable numpad navigation.");var n=document.createElement("a");n.className="fakebutton",n.href="javascript:change_macros();",n.innerHTML="<big>Save</big>",t.appendChild(n),add_element(t,"span","&nbsp;&nbsp;&nbsp;");var o=document.createElement("a");o.className="fakebutton",o.href="javascript:close_popup();",o.innerHTML="<big>Cancel</big>",t.appendChild(o)}function menu_history_flush(){DecafMUD.instances[0].ui.display.clear()}function change_macros(){var e=document.formmacros.cfkey.checked,t=document.formmacros.cnumpad.checked;toggle_fkeys(e),toggle_numpad(t),close_popup()}function menu_progressbars(){progress_visible()?toggle_progressbars(!1):toggle_progressbars(!0)}function menu_map(){if(showmap){toggle_map(!1),alert("Warning: the map will automatically reappear when the mud sends it.  To stop the side-map, change your settings in options output map.");var e=document.getElementById("submenu_options"),t=document.getElementById("submenu_options_map");e.removeChild(t)}}function menu_features(){var e,t=popup_textdiv(show_popup());add_element(t,"h2","Client Features"),add_element(t,"p","Decafmud is a basic mud client, with just a few features."),e=document.createElement("ul"),t.appendChild(e),add_element(e,"li","To send multiple commands at once, separate them by putting ;; in between.<br>For example: <tt>look;;score</tt>"),add_element(e,"li","You can browse your previous commands with the up and down arrow keys."),add_element(e,"li",'The F1, F2, ... keys send the commands f1, f2, ... to the mud.  You can use the MUD\'s alias system to attach commands to this, for example "alias f1 score".  Use "help alias" when logged in to the mud for more information.'),add_element(e,"li","You can use the numpad for quick navigation.  Make sure you have the numlock key on for it to work."),add_element(e,"li","You can clear the input field immediately using shift+backspace (useful for MUDs where you send a blank line to interrupt the current action)."),add_element(e,"li","To create a log file from your current session, use the Log menu.  Unfortunately it is not possible (due to browers' security restrictions) to automatically save a file to your computer, so you will have to copy it to a text editor yourself."),add_close_button(button_line(t))}function menu_about(){DecafMUD.instances[0].about()}function menu_trouble(){window.open("help.html","Troubleshooting","width=800,height=400,resizable=yes,scrollbar=yes,toolbar=yes,menubar=no,location=no,directories=no,status=no")}