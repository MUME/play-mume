/*! For license information please see decafmud.telopt.zmp.js.LICENSE.txt */
!function(t){var n=t.TN,e=function(t){this.decaf=t,this.decaf.zmp=this};e.prototype.sendZMP=function(t,e){var i="";void 0!==e&&(i="\0"+e.join("\0")),this.decaf.sendIAC(n.IAC+n.SB+n.ZMP+t+i+"\0"+n.IAC+n.SE)},e.prototype._will=function(){var n=this;setTimeout(function(){n.sendZMP("zmp.ident",["DecafMUD",t.version.toString(),"HTML5 MUD Client - keep Java out of your browser"])},0)},e.prototype._sb=function(e){if(!(e.indexOf("\0")<1)){var i=e.split("\0"),o=i.shift();this.decaf.debugString("RCVD "+t.debugIAC(n.IAC+n.SB+n.ZMP+e+n.IAC+n.SE));var r=this.getFunction(o);return r&&r.call(this,o,i),!1}},e.prototype.getFunction=function(t,n){for(var i=t.split("."),o=e.commands;i.length>0;){var r=i.shift();if(void 0===o[r])return;o=o[r]}return"function"==typeof o||!0===n?o:void 0},e.prototype.addFunction=function(t,n){var i=t.split(".");t=i.pop();for(var o=e.commands;i.length>0;){var r=i.shift();void 0===o[r]&&(o[r]={}),o=o[r]}o[t]=n},(e.commands={}).zmp={check:function(t,n){for(var e=0,i=n.length;e<i;e++){var o=n[e];o.length>0&&(func=this.getFunction("."==o.substr(-1)?o.substr(0,o.length-1):o,!0),void 0===func?this.sendZMP("zmp.no-support",[o]):this.sendZMP("zmp.support",[o]))}},ping:function(t,n){var e=new Date,i=e.getUTCFullYear().toString(),o=(e.getUTCMonth()+1).toString(),r=e.getUTCDate().toString(),s=e.getUTCHours().toString(),u=e.getUTCMinutes().toString(),g=e.getUTCSeconds().toString();o.length<2&&(o="0"+o),r.length<2&&(r="0"+r),s.length<2&&(s="0"+s),u.length<2&&(u="0"+u),g.length<2&&(g="0"+g),this.sendZMP("zmp.time",[i+"-"+o+"-"+r+" "+s+":"+u+":"+g])}},t.plugins.Telopt[n.ZMP]=e}(DecafMUD);