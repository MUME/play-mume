/*! For license information please see decafmud.socket.flash.js.LICENSE.txt */
!function(t){var e=function(t){this.decaf=t,this.id="DecafFlashSocket__"+ ++e.last_id};e.last_id=0,e.sockets={},e.prototype.host=void 0,e.prototype.port=void 0,e.prototype.ssl=void 0,e.prototype.connected=!1,e.prototype.socket=null,e.prototype.ready=!1,e.prototype.setup=function(t){clearTimeout(this.decaf.timer);var e=this;if(void 0===t&&(t=0,this.decaf.debugString("Loading Flash socket support...")),void 0===window.swfobject){if(t||this.decaf.loadScript("swfobject.js"),t<100)return void(this.decaf.timer=setTimeout(function(){e.setup(t+1)},25));this.decaf.error("Unable to load SWFObject. Please download it from {0}.".tr(this.decaf,'<a href="http://code.google.com/p/swfobject/">http://code.google.com/p/swfobject/</a>'))}var o=this.decaf.options.set_socket.swf;for(this.decaf.timer=setTimeout(function(){e.noSocket()},2500);null!==document.getElementById(this.id);)this.id+="_";var s=document.createElement("div");s.style.cssText="display:none;position:absolute;width:0;height:0;left:-9000px;overflow:hidden!important;margin:0!important;padding:0!important;",s.id=this.id,document.body.insertBefore(s,document.body.firstChild),swfobject.embedSWF(o+"?"+this.id,this.id,"0","0","9.0.0",!1,{},{menu:"false"},{},function(t){e.onSocket(t)})},e.prototype.noSocket=function(){clearTimeout(this.decaf.timer),this.decaf.error("Unable to create a Flash socket. Please ensure that you have the Adobe Flash plugin installed and that it's currently up to date.".tr(this.decaf))},e.prototype.onSocket=function(t){if(clearTimeout(this.decaf.timer),t.success)e.sockets[t.id]=this,this.socket=t.ref;else if(swfobject.hasFlashPlayerVersion("9.0.0"))this.decaf.error("There was an unknown error (though most likely a 404) loading the Flash socket file.".tr(this.decaf));else{var o=swfobject.getFlashPlayerVersion();0===o.major?this.decaf.error('DecafMUD\'s Flash connectivity requires Adobe Flash 9 or later. Please <a href="http://get.adobe.com/flashplayer/">install</a> Flash.'.tr(this.decaf)):this.decaf.error('DecafMUD\'s Flash connectivity requires at least Adobe Flash version 9.0. You have version {0}.{1}.{2}. Please <a href="http://get.adobe.com/flashplayer/">upgrade</a> your Flash plugin.'.tr(this.decaf,o.major,o.minor,o.release))}},e.prototype.connect=function(){this.connected&&this.socket&&this.socket.close(),843!==this.decaf.options.set_socket.policyport&&void 0!==this.decaf.options.set_socket.policyport&&this.socket.setPolicyPort(this.decaf.options.set_socket.policyport);var t=this.host,e=this.port,o=this.ssl;void 0===t&&((t=this.decaf.options.host)||(t=document.location.host),this.host=t),void 0===e&&(e=this.decaf.options.port,this.port=e),void 0===o&&(void 0===(o=this.decaf.options.set_socket.ssl)&&(o=!1),this.ssl=o),this.socket.connect(t,e,o)},e.prototype.close=function(){this.connected=!1,this.socket&&this.socket.close()},e.prototype.assertConnected=function(){if(!this.connected||!this.socket)throw"DecafMUD is not currently connected."},e.prototype.write=function(t){this.assertConnected(),this.socket.write(t.replace(/\x00/g,"î€€"))},t.flashCallback=function(t,o,s,c){setTimeout(function(){e.executeCallback(t,o,s,c)},0)},e.executeCallback=function(o,s,c,i){var a=e.sockets[o];0===s?(a.ready=!0,a.decaf.socketReady(a)):1===s?(a.connected=!0,a.decaf.socketConnected(a)):2===s?(a.connected=!1,a.decaf.socketClosed(a)):3===s?a.decaf.socketError(c,i):4===s?c.length>0&&a.decaf.socketData(c.replace(/\uE000/g,"\0")):5===s?"mccp"==c?a.decaf.debugString("RCVD "+t.debugIAC(i)):"mccp-out"===c?a.decaf.debugString("SENT "+t.debugIAC(i)):(i=void 0!==i?'  data2="'+i+'"':"",a.decaf.debugString("Flash Debug: "+c+i)):a.decaf.debugString('Unknown Flash Callback: type={0} data="{1} data2="{2}"'.tr(a.decaf,s,c,i))},t.plugins.Socket.flash=e,DecafMUDFlashSocket={},DecafMUDFlashSocket.flashCallback=t.flashCallback}(DecafMUD);